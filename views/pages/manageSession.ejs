<%- include('../partials/header') %>

<div class="container py-5">
    <h2 class="mb-4 text-center">Manage Sessions</h2>
    <div class="card shadow-lg p-4 animate__animated animate__fadeInUp">
        <table class="table table-hover">
            <thead>
                <tr>
                    <th>Student</th>
                    <th>Date</th>
                    <th>Time</th>
                    <th>Notes</th>
                    <th>Status</th>
                </tr>
            </thead>
           <tbody>
    <% if (sessions.length > 0) { %>
        <% sessions.forEach(session => { %>
            <tr>
                <td>
    <% if (session.student) { %>
        <%= session.student.username %> (<%= session.student.email %>)
    <% } else { %>
        Unknown Student
    <% } %>
</td>

                <td>
  <% if (session.date) { %>
    <%= new Date(session.date).toDateString() %>
  <% } else { %>
    Not Provided
  <% } %>
</td>

                <td><%= session.time %></td>
                <td><%= session.notes || 'â€”' %></td>
                <td>
                    <% if (session.status === 'pending') { %>
                        <form action="/therapist/session/<%= session._id %>/approve" method="POST" style="display:inline;">
                            <button class="btn btn-success btn-sm">Approve</button>
                        </form>
                        <form action="/therapist/session/<%= session._id %>/reject" method="POST" style="display:inline;">
                            <button class="btn btn-danger btn-sm">Reject</button>
                        </form>
                    <% } else { %>
                        <span class="badge <%= session.status === 'approved' ? 'bg-success' : 'bg-danger' %>">
                            <%= session.status %>
                        </span>
                    <% } %>
                </td>
            </tr>
        <% }) %>
    <% } else { %>
        <tr>
            <td colspan="5" class="text-center">No sessions booked yet.</td>
        </tr>
    <% } %>
</tbody>

        </table>
    </div>
</div>

<%- include('../partials/footer') %>
